<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Ticket</title>
    <script>
        function bookTicket(event) {
            event.preventDefault(); // Prevent the form from submitting normally

            // Get form data
            const formData = new FormData(event.target);
            const bookingData = {
                userId: formData.get('email'),  // Using email as userId
                routeId: formData.get('routeId'),
                passengerName: formData.get('customerName'),
                paymentMode: "Credit Card", // Assuming default payment mode
                status: "CONFIRMED"
            };

            // Send data as JSON using fetch API
            fetch("/WebTravelBookingRESTProject/api/bookings", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(bookingData) // Convert data to JSON
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Booking failed!");
                }
                return response.json();
            })
            .then(data => {
                alert("Booking successful! ID: " + data.id); // Assuming the response includes the ID
            })
            .catch(error => {
                alert(error.message);
            });
        }
    </script>
</head>
<body>
    <h2>Book a Ticket</h2>
    <form id="bookingForm" onsubmit="bookTicket(event)">
        Name: <input type="text" name="customerName" required><br>
        Email: <input type="email" name="email" required><br>
        Contact: <input type="text" name="contact" required><br>
        Route ID: <input type="text" name="routeId" required><br>
        Number of Seats: <input type="number" name="seatCount" min="1" required><br><br>
        <input type="submit" value="Book Ticket">
    </form>
</body>
</html>
